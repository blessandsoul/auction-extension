# Definitive Guide to AuctionGate User Restrictions

This document serves as the exhaustive technical reference for all user-facing restrictions, blocks, and control mechanisms implemented in the AuctionGate extension. It categorizes restrictions by their function and implementation method.

---

## 1. Security & Anti-Tampering Layers

These mechanisms ensure the user cannot bypass the extension's logic or use competing tools.

### 1.1 Developer Tools Lockout
*   **Behavior:** Users cannot inspect elements, debug code, or view the console.
*   **Triggers:** Keypress of `F12`, `Ctrl+Shift+I`, `Ctrl+U`.
*   **Enforcement:**
    *   **Client-Side:** `js/devTools.js` prevents the default browser action for these keys.
    *   **Server-Side:** `background.js` polls `chrome.debugger`. If a debugger is attached to *any* auction tab, that tab is **immediately closed**. If attached to the extension itself, the extension **disables itself**.

### 1.2 Extension Conflict Warfare
*   **Behavior:** The extension refuses to run if specific "hostile" extensions are present.
*   **Triggers:** Detection of extensions with `webRequestBlocking` or `proxy` permissions, or specific names (e.g., "Proxy Extension").
*   **Enforcement:** `checkExtensions()` in `background.js` sets a `issetPotentiallyHarmfulExtensions` flag that forces a user logout and displays a "Potentially Harmful Extension" error popup.

### 1.3 Manheim "Dead Man's Switch"
*   **Behavior:** If the AuctionGate extension is disabled or stops responding while on Manheim, the user is instantly logged out.
*   **Enforcement:** `manheimControlExtentionAvailability.js` pings the background script every second. If the ping fails, it **erases all cookies** and redirects to a logout URL.

---

## 2. Bidding Logic & Business Rules (The "Business Physics")

The extension imposes a strict "physics engine" on bidding, preventing actions that violate server-side limits.

### 2.1 Live Auction Entry
*   **Behavior:** "Join Auction" buttons are disabled or redirect to the home page.
*   **Condition:** User has `owner_balance <= 0` OR server setting `live_bid` is `false`.
*   **Enforcement:** `copartLiveLinksControl.js` and `iaaiLiveLinksControl.js` mutate the DOM to disable these links.

### 2.2 Live Bidding: State-Based Geofencing
*   **Behavior:** Inside the Live Auction (G2) interface, a user **cannot bid** on a vehicle if their account is not authorized for the specific US State where the car is located.
*   **Condition:** The lot's state code (e.g., "TX", "CA") is not in the `current_account_copart_states` list.
*   **Enforcement:** `copartLiveStateControl.js` monitors the auction stream. If a restricted lot appears:
    *   The background turns **Red**.
    *   All bid buttons are **disabled**.

### 2.3 Live Bidding: Dynamic Limits
*   **Behavior:** Bid buttons are dynamically disabled (greyed out) *during* the auction if the next bid increment would violate a limit.
*   **Conditions:**
    *   **Max Single Bid:** Proposed bid > `summ_one_bet`.
    *   **Total Exposure:** (Current active bids + Proposed bid) > `active_bids_sum_limit`.
    *   **Bid Count:** Total number of active bids >= `active_bids_limit`.
*   **Enforcement:** `copartLiveBidControl.js` watches the "Next Bid" value and toggles the `disabled` attribute on the bid buttons in real-time.

### 2.4 Pre-Bidding Restrictions
*   **Behavior:** "Make Offer" or "Bid Now" buttons are disabled or removed on the lot details page.
*   **Enforcement:** `copartPrebidControl.js` & `iaaiPrebid.js`.
    *   Calculates if the user has enough "slots" or "budget" remaining.
    *   If restricted, it injects a popup message: *"The opportunity to place a pre-bid is closed, use the online bidding."* (This is often a fake message generated by the extension to block the user, not a real message from the site).

---

## 3. Financial & Account UI Hiding

The extension ensures the user acts only as a bidder, never as an account administrator.

### 3.1 The "Pay Now" Blockade
*   **Behavior:** Users cannot see or click payment buttons for won vehicles.
*   **Target Pages:** Copart "Unpaid Invoices", IAAI "Payments".
*   **Enforcement:** `copartHidePayData.js` and `iaaiHidePayData.js`.
    *   Removes `.balance-due-button`.
    *   Removes `.payment-summary` tables.
    *   Removes payment method selectors (credit card/wire options).

### 3.2 Account Section Surgical Removal
*   **Behavior:** Navigation links to sensitive account areas are removed from menus.
*   **Target Sections:**
    *   **Copart:** `bidders`, `accountinformation`, `deposit`, `funds`, `lotswon` (if configured to hide).
    *   **IAAI:** `/user` (Profile), `/payment`, `/purchasehistory`.
*   **Enforcement:** `copartHidePages.js` and `iaaiHidePages.js` scan all `<a>` tags and remove those matching restricted paths.

### 3.3 Identity Masking (Manheim)
*   **Behavior:** The user sees the *Extension's* configured username instead of the *Real* auction account holder's name.
*   **Enforcement:** `manheimSiteContentControl.js` overwrites the inner text of `.uhf-account__contact` and `#userFirstInitial` with the `user_name` from local storage.

---

## 4. Access Control Gates

### 4.1 The "Base" Plan Handicap
Users on the "Base" tariff are functionally crippled:
*   **No Auto-Login:** Must type passwords manually (simulated login disabled).
*   **No History:** Bids are not logged to the extension's backend.
*   **Prebid Block:** Default state often blocks pre-bids on IAAI logic.

### 4.2 Zero Balance Lockout
*   **Behavior:** Immediate redirect if the user tries to access the dashboard.
*   **Condition:** `owner_balance <= 0`.
*   **Enforcement:** `guestLoginControl.js` watches the URL. If the user navigates to `/auctiondashboard` (Copart) or `/auctiongateway` (IAAI), they are forced back to the homepage.

### 4.3 Version Expiration
*   **Behavior:** Login fails with an "outdated" error.
*   **Condition:** `extension_version` < `minimal_extension_version` (Server setting).
*   **Enforcement:** `logIn` function in `background.js` aborts the auth flow.
